<table mat-table [dataSource]="dataSource" matSort matSortDisableClear class="mat-elevation-z8">
  <ng-container matColumnDef="number">
    <th mat-header-cell *matHeaderCellDef mat-sort-header></th>
    <td mat-cell class="number" *matCellDef="let activity">
      {{tpd(activity).number | number:'2.0'}}
    </td>
    <td mat-footer-cell *matFooterCellDef></td>
  </ng-container>

  <ng-container matColumnDef="name">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Aktivit√§t</th>
    <td mat-cell *matCellDef="let activity">{{tpd(activity).name}}</td>
    <td mat-footer-cell *matFooterCellDef>Total</td>
  </ng-container>

  <ng-container matColumnDef="startDate">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Start</th>
    <td mat-cell *matCellDef="let activity">
      {{tpd(activity).startDate.toDate() | date : 'mediumDate'}}
    </td>
    <td mat-footer-cell *matFooterCellDef></td>
  </ng-container>

  <ng-container matColumnDef="endDate">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Ende</th>
    <td mat-cell *matCellDef="let activity">
      {{tpd(activity).endDate?.toDate() | date : 'mediumDate'}}
    </td>
    <td mat-footer-cell *matFooterCellDef></td>
  </ng-container>

  <ng-container matColumnDef="budgetTime">
    <th mat-header-cell *matHeaderCellDef>Soll</th>
    <td mat-cell *matCellDef="let activity">
      <span *ngIf="!tpd(activity).budget.isZero">
        {{tpd(activity).budget.personDays| number:'1.1-1'}} PT
      </span>
    </td>
    <td mat-footer-cell *matFooterCellDef>
      <span *ngIf="!subproject.budget.isZero">
        {{subproject.budget.personDays| number:'1.1-1'}} PT
      </span>
    </td>
  </ng-container>

  <ng-container matColumnDef="actualTime">
    <th mat-header-cell *matHeaderCellDef>Ist</th>
    <td mat-cell *matCellDef="let activity">
      {{tpd(activity).actual.personDays | number:'1.1-1'}} PT
      <mat-icon color="warn" *ngIf="tpd(activity).isOverBudget" matTooltip="Ist > Soll"
        >warning</mat-icon
      >
    </td>
    <td mat-footer-cell *matFooterCellDef>
      {{subproject.actual.personDays | number:'1.1-1'}} PT
      <mat-icon color="warn" *ngIf="subproject.isOverBudget" matTooltip="Ist > Soll"
        >warning</mat-icon
      >
    </td>
  </ng-container>

  <ng-container matColumnDef="plannedTime">
    <th mat-header-cell *matHeaderCellDef>Geplant</th>
    <td mat-cell *matCellDef="let activity">
      <span *ngIf="!tpd(activity).planned.isZero">
        {{tpd(activity).planned.personDays| number:'1.1-1'}} PT
      </span>
    </td>
    <td mat-footer-cell *matFooterCellDef>
      <span *ngIf="!subproject.planned.isZero">
        {{subproject.planned.personDays| number:'1.1-1'}} PT
      </span>
    </td>
  </ng-container>

  <ng-container matColumnDef="isBillable">
    <th mat-header-cell *matHeaderCellDef mat-sort-header>Verrechenbar</th>
    <td mat-cell class="isBillable" *matCellDef="let activity">
      <mat-icon *ngIf="tpd(activity).isBillable">check</mat-icon>
    </td>
    <td mat-footer-cell *matFooterCellDef></td>
  </ng-container>

  <ng-container matColumnDef="tools">
    <th mat-header-cell *matHeaderCellDef></th>
    <td mat-cell class="tools" *matCellDef="let activity">
      <a mat-icon-button [routerLink]="['activity', tpd(activity).id]">
        <mat-icon>edit</mat-icon>
      </a>
    </td>
    <td mat-footer-cell *matFooterCellDef></td>
  </ng-container>

  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr
    mat-row
    *matRowDef="let activity; columns: displayedColumns;"
    [routerLink]="hasWriteAccess ? ['activity', tpd(activity).id] : null"></tr>
  <tr mat-footer-row *matFooterRowDef="displayedColumns"></tr>
</table>
