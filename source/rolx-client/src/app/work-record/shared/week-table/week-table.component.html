<table mat-table #table [dataSource]="allPhases" class="mat-elevation-z8">

  <ng-container matColumnDef="phase">
    <th mat-header-cell *matHeaderCellDef>Projekt - Phase</th>

    <td mat-cell *matCellDef="let phase">
      <span *ngIf="phase else phaseSelector">
        <rolx-starred-phase-indicator [phase]="phase"></rolx-starred-phase-indicator>
        {{phase.fullName}}
      </span>

      <ng-template #phaseSelector>
        <rolx-phase-selector [excluded]="phases"
                             [begin]="records[0]?.date"
                             [end]="records[records.length-1]?.date"
                             (selected)="addHomegrown($event);table.renderRows()"></rolx-phase-selector>
      </ng-template>
    </td>

    <td mat-footer-cell *matFooterCellDef>
      <button mat-icon-button
              aria-label="Phase hinzufÃ¼gen"
              (click)="startAdding();table.renderRows()"
              [disabled]="isAddingPhase">
        <mat-icon>add</mat-icon>
      </button>
    </td>
  </ng-container>

  <ng-container *ngFor="let weekday of weekdays; let i = index"
                [matColumnDef]="weekday">

    <th mat-header-cell
        *matHeaderCellDef
        class="day-header"
        [class.non-workday]="!records[i].isWorkday">

      <span>{{records[i].date | date: 'mediumDate'}}</span>
      <ng-container *ngIf="records[i].dayName">
        <br/>
        <small>{{records[i].dayName}}</small>
      </ng-container>

    </th>

    <td mat-cell
        *matCellDef="let phase, let row = index"
        class="day"
        [class.non-workday]="!records[i].isWorkday">
      <rolx-week-table-cell *ngIf="phase"
                            [row]="row"
                            [column]="i"
                            [record]="records[i]"
                            [phase]="phase"></rolx-week-table-cell>
    </td>

    <td mat-footer-cell
        *matFooterCellDef
        class="day"
        [class.non-workday]="!records[i].isWorkday">

      <span>
        {{records[i].overtime}}
      </span>

    </td>

  </ng-container>

  <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
  <tr mat-row *matRowDef="let phase; columns: displayedColumns;"></tr>
  <tr mat-footer-row *matFooterRowDef="displayedColumns"></tr>

</table>
